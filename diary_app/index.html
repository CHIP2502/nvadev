<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Nháº­t kÃ½</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>ğŸ“” Nháº­t kÃ½ cÃ¡ nhÃ¢n</h1>

  <!-- Form Ä‘Äƒng nháº­p -->
  <div id="login-section">
    <h2>ÄÄƒng nháº­p</h2>
    <input id="username" placeholder="TÃªn Ä‘Äƒng nháº­p">
    <input id="password" type="password" placeholder="Máº­t kháº©u">
    <button onclick="login()">ÄÄƒng nháº­p</button>
    <p id="login-msg"></p>
  </div>

  <!-- Form viáº¿t nháº­t kÃ½ -->
  <div id="diary-section" style="display:none;">
    <h2>âœï¸ Viáº¿t nháº­t kÃ½</h2>
    <input id="title" placeholder="TiÃªu Ä‘á»">
    <input id="emotion" placeholder="Cáº£m xÃºc (ğŸ˜ŠğŸ˜¢ğŸ˜¡)">
    <input id="date" type="datetime-local">
    <textarea id="content" placeholder="Ná»™i dung..."></textarea><br>
    <label><input type="checkbox" id="isPublic"> ÄÄƒng cÃ´ng khai</label><br>
    <button onclick="saveEntry()">LÆ°u nháº­t kÃ½</button>
    <p id="save-msg"></p>

    <hr>
    <h2>ğŸ“– Nháº­t kÃ½ cá»§a tÃ´i</h2>
    <div id="my-entries"></div>

    <hr>
    <a href="public.html">ğŸ“¢ Xem nháº­t kÃ½ cÃ´ng khai</a>
  </div>

  <script>
    const users = [
      {username: "user1", password: "123"},
      {username: "user2", password: "456"}
    ];
    let currentUser = null;

    function login(){
      const u = document.getElementById("username").value;
      const p = document.getElementById("password").value;
      const valid = users.find(x => x.username===u && x.password===p);
      if(valid){
        currentUser = u;
        document.getElementById("login-section").style.display="none";
        document.getElementById("diary-section").style.display="block";
        loadMyEntries();
      } else {
        document.getElementById("login-msg").innerText="âŒ Sai tÃ i khoáº£n hoáº·c máº­t kháº©u!";
      }
    }

    function saveEntry(){
      if(!currentUser) return;
      const entry = {
        user: currentUser,
        title: document.getElementById("title").value,
        emotion: document.getElementById("emotion").value,
        date: document.getElementById("date").value,
        content: document.getElementById("content").value,
        isPublic: document.getElementById("isPublic").checked
      };
      let entries = JSON.parse(localStorage.getItem("diaryEntries")||"[]");
      entries.push(entry);
      localStorage.setItem("diaryEntries", JSON.stringify(entries));
      document.getElementById("save-msg").innerText="âœ… ÄÃ£ lÆ°u!";
      loadMyEntries();
    }

    function loadMyEntries(){
      let entries = JSON.parse(localStorage.getItem("diaryEntries")||"[]");
      let myEntries = entries.filter(e => e.user === currentUser);
      const container = document.getElementById("my-entries");
      container.innerHTML="";
      if(myEntries.length===0){
        container.innerHTML="<p>ChÆ°a cÃ³ nháº­t kÃ½ nÃ o.</p>";
        return;
      }
      myEntries.forEach(e=>{
        const div=document.createElement("div");
        div.className="entry";
        div.innerHTML=`
          <h3>${e.title} (${e.emotion})</h3>
          <p><b>NgÃ y:</b> ${e.date}</p>
          <p>${e.content}</p>
          <small>${e.isPublic?"ğŸŒ CÃ´ng khai":"ğŸ”’ RiÃªng tÆ°"}</small>
        `;
        container.appendChild(div);
      });
    }
  </script>
</body>
</html>
